# Conditionally set array of packages to install
# vim: filetype=bash

eval "$(. /etc/os-release && typeset -p ID)"
packages=()

# Always install
packages+=(
  zsh
  git
  curl
  gawk
  tree
  htop
  stow
  shellcheck
  ranger
  w3m
)

# Debian-based only (apt)
[[ $ID =~ ^(debian|ubuntu)$ ]] && packages+=(
  wget2
)

# Mosh dependencies
# - bastion hosts and laptop/desktop clients (name starts with h)
if [[ $(hostname -s) =~ ^(bastet|h.+)$ ]]; then
  # Debian-based
  [[ $ID =~ ^(debian|ubuntu)$ ]] && packages+=(
    openssh-client
    ssh-askpass
    autossh
  )
  # RHEL-based
  [[ $ID =~ ^(fedora|amzn|ol)$ ]] && packages+=(
    openssh-clients
    openssh-askpass
    autossh
  )
fi

# Linux desktop/laptop clients (not WSL)
if [[ -n $DISPLAY ]] && grep -vqi microsoft /proc/version; then
  packages+=(
    copyq
  )
fi
